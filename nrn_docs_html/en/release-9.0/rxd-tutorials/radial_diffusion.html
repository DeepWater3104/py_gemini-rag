

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="readthedocs-addons-api-version" content="1"><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Radial diffusion &mdash; NEURON  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=6933245a" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/tabs.js?v=3ee01567"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>
    <script src="../_static/js/versions.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reaction-diffusion thresholds" href="thresholds.html" />
    <link rel="prev" title="Varying initial concentrations and parameters" href="Changing%20initial%20conditions%20and%20parameters.html" /> 
<script async type="text/javascript" src="/_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="nrn" /><meta name="readthedocs-version-slug" content="release-9.0" /><meta name="readthedocs-resolver-filename" content="/rxd-tutorials/radial_diffusion.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            NEURON
          </a>
              <div class="switch-menus">
                <div class="version-switch"></div>
                <div class="language-switch"></div>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Building:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cmake_doc/options.html">CMake Build Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/developer.html">Developer Builds</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../videos/index.html">Training videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../courses/exercises2018.html">NEURON Course Exercises</a></li>
<li class="toctree-l1"><a class="reference external" href="https://neuron.yale.edu/phpBB">The NEURON forum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications about NEURON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications-using-neuron.html">Publications using NEURON</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NEURON scripting:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../scripting.html">Running Python and HOC scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../progref/index.html">NEURON Programmer’s Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../otherscripting.html">Other scripting languages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Python tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Python RXD tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Reaction-Diffusion%20tutorial.html">Reaction-diffusion introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic-initialization.html">Initialization Strategies</a></li>
<li class="toctree-l2"><a class="reference internal" href="Changing%20initial%20conditions%20and%20parameters.html">Varying initial concentrations and parameters</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Radial diffusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="thresholds.html">Reaction-diffusion thresholds</a></li>
<li class="toctree-l2"><a class="reference internal" href="extracellular.html">Extracellular reaction-diffusion tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="Restricting%20reactions%20to%20certain%20sections.html">Restricting reactions to a part of a region</a></li>
<li class="toctree-l2"><a class="reference internal" href="degradable_buffer.html">Example: Degradable buffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="circadian.html">Example: Circadian rhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="calcium%20waves.html">Example: Calcium waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="combining%20currents%20from%20mod%20files%20with%20rxd.html">Example: combining MOD file ion channels with rxd</a></li>
<li class="toctree-l2"><a class="reference internal" href="ip3-demo.html">IP3 demo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../coreneuron/index.html">CoreNEURON</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NMOD Language:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nmodl/language.html">Language Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nmodl/transpiler/index.html">About the NMODL transpiler</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scm/index.html">NEURON SCM and Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/index.html">NEURON Development topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../capi.html">C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doxygen.html">Internal C/C++ documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Removed Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../removed_features.html">Removed Features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Changelog</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">NEURON 9.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#neuron-8-2">NEURON 8.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#neuron-8-1">NEURON 8.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#neuron-8-0">NEURON 8.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#contributors">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#feedback-help">Feedback / Help</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NEURON</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Python RXD tutorials</a></li>
      <li class="breadcrumb-item active">Radial diffusion</li>
<li class="wy-breadcrumbs-aside">
    
    
</li>

      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/rxd-tutorials/radial_diffusion.ipynb.txt" rel="nofollow"> View page source</a>
      </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Radial-diffusion">
<h1>Radial diffusion<a class="headerlink" href="#Radial-diffusion" title="Link to this heading"></a></h1>
<p><p>Radial diffusion can be implemented in rxd using multicompartment reactions. By creating a series of shells and borders with reactions between them dependent the diffusion coefficient.</p>
</p><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">neuron</span><span class="w"> </span><span class="kn">import</span> <span class="n">n</span><span class="p">,</span> <span class="n">rxd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">neuron.units</span><span class="w"> </span><span class="kn">import</span> <span class="n">nM</span><span class="p">,</span> <span class="n">uM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>

<span class="n">n</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;stdrun.hoc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
<p>Create the NEURON, in this case a simply dendrite connected to a soma.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">soma</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="s2">&quot;soma&quot;</span><span class="p">)</span>
<span class="n">soma</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">soma</span><span class="o">.</span><span class="n">diam</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">soma</span><span class="o">.</span><span class="n">nseg</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">dend</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="s2">&quot;dend&quot;</span><span class="p">)</span>
<span class="n">dend</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">dend</span><span class="o">.</span><span class="n">diam</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">dend</span><span class="o">.</span><span class="n">nseg</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">dend</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">soma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dend
</pre></div></div>
</div>
<p><p>Following the rxd Where/Who/What framework start by defining the where the diffusion takes place. Here we use 5 shells each with thickness 1μM in the dendrite and 5μM in the soma.</p>
</p><div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Where -- define the shells and borders</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># number of shells -- must be &gt;= 2</span>

<span class="c1"># Where -- shells and border between them</span>
<span class="n">shells</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">border</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">shells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">rxd</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span>
            <span class="n">n</span><span class="o">.</span><span class="n">allsec</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;shell</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">geometry</span><span class="o">=</span><span class="n">rxd</span><span class="o">.</span><span class="n">Shell</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">border</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">rxd</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span>
            <span class="n">n</span><span class="o">.</span><span class="n">allsec</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;border</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">geometry</span><span class="o">=</span><span class="n">rxd</span><span class="o">.</span><span class="n">FixedPerimeter</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">n</span><span class="o">.</span><span class="n">PI</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">i</span><span class="p">)),</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># the outer shell corresponds NEURON section concentration e.g. dend(0.5).cai</span>
<span class="n">shells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="n">rxd</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span>
        <span class="n">n</span><span class="o">.</span><span class="n">allsec</span><span class="p">(),</span>
        <span class="n">nrn_region</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;shell</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">geometry</span><span class="o">=</span><span class="n">rxd</span><span class="o">.</span><span class="n">Shell</span><span class="p">((</span><span class="n">N</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p><p>Next we define ‘Who’ the calcium that is diffusing. Because multicompartment reactions are specified in moleques/μ m2 /ms we need to scale the diffusion coefficient used in the reactions. We start the simulation with the a high concentration (1μ</p>
<ol class="upperalpha" start="13">
<li><p>in the middle of the dendrite on the outer shell.</p>
<p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Who -- calcium with an inhomogeneous initial condition</span>
<span class="n">Dca</span> <span class="o">=</span> <span class="mf">0.6</span>  <span class="c1"># um^2/ms</span>

<span class="c1"># scale factor so the flux (Dca/dr)*Ca has units molecules/um^2/ms (where dr is the thickness of the shell)</span>
<span class="n">mM_to_mol_per_um</span> <span class="o">=</span> <span class="mf">6.0221409e23</span> <span class="o">*</span> <span class="mf">1e-18</span>

<span class="n">ca</span> <span class="o">=</span> <span class="n">rxd</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span>
    <span class="n">shells</span><span class="p">,</span>
    <span class="n">d</span><span class="o">=</span><span class="n">Dca</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ca&quot;</span><span class="p">,</span>
    <span class="n">charge</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">initial</span><span class="o">=</span><span class="k">lambda</span> <span class="n">nd</span><span class="p">:</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">uM</span>
    <span class="k">if</span> <span class="mf">9.5</span> <span class="o">&lt;</span> <span class="n">nd</span><span class="o">.</span><span class="n">x3d</span> <span class="o">-</span> <span class="n">soma</span><span class="o">.</span><span class="n">L</span> <span class="o">&lt;</span> <span class="mf">10.5</span> <span class="ow">and</span> <span class="n">nd</span><span class="o">.</span><span class="n">region</span> <span class="o">==</span> <span class="n">shells</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">nM</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p><p>Finally we specify ‘What’ the reactions that perform the radial diffusion.</p>
</p><div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># What -- use reactions to setup diffusion between the shells</span>
<span class="n">cas</span> <span class="o">=</span> <span class="p">[</span><span class="n">ca</span><span class="p">[</span><span class="n">reg</span><span class="p">]</span> <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="n">shells</span><span class="p">]</span>  <span class="c1"># calcium on the shells</span>

<span class="c1"># create the multi-compartment reactions between the pairs of shells</span>
<span class="n">diffusions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">diffusions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">rxd</span><span class="o">.</span><span class="n">MultiCompartmentReaction</span><span class="p">(</span>
            <span class="n">cas</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">cas</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">mM_to_mol_per_um</span> <span class="o">*</span> <span class="n">Dca</span><span class="p">,</span>
            <span class="n">mM_to_mol_per_um</span> <span class="o">*</span> <span class="n">Dca</span><span class="p">,</span>
            <span class="n">border</span><span class="o">=</span><span class="n">border</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<p><p>Now run the simulation and plot the results. The concentrations rapidly equilibrate between the shells, the speed is dependent on the diffusion coefficient, which could be reduced to account for tortuosity of macromolecular crowding in the cytosol. Additionally calcium buffering and uptake could be included with additional reactions and would also reduce this speed.</p>
</p><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># run for 2.5ms and plot the results</span>
<span class="n">n</span><span class="o">.</span><span class="n">finitialize</span><span class="p">(</span><span class="o">-</span><span class="mi">65</span><span class="p">)</span>
<span class="n">n</span><span class="o">.</span><span class="n">continuerun</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>

<span class="c1"># plot the calcium concentration (in nM) in the dendrite</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Calcium (nM) in the dendrite&quot;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ca</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">dend</span><span class="p">)</span><span class="o">.</span><span class="n">concentration</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dend</span><span class="o">.</span><span class="n">nseg</span><span class="p">)</span> <span class="o">/</span> <span class="n">nM</span><span class="p">,</span>
    <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span>
    <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dend</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dend</span><span class="o">.</span><span class="n">diam</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span>
    <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x ($\mu$m)&quot;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;r ($\mu$m)&quot;</span><span class="p">)</span>


<span class="c1"># plot the calcium concentration in the neuron in each of the shells</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Concentration in each shell of the neuron&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">shell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shells</span><span class="p">):</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="p">[</span><span class="n">nd</span><span class="o">.</span><span class="n">x3d</span> <span class="o">-</span> <span class="n">soma</span><span class="o">.</span><span class="n">L</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">ca</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">shell</span><span class="p">)],</span>
        <span class="p">[</span><span class="n">nd</span><span class="o">.</span><span class="n">concentration</span> <span class="o">/</span> <span class="n">nM</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">ca</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">shell</span><span class="p">)],</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;shell$_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x ($\mu$m)&quot;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Ca$^{+2}$ (nM)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;&gt;:15: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:16: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:29: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:15: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:16: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:29: SyntaxWarning: invalid escape sequence &#39;\m&#39;
/tmp/ipykernel_8549/3075494742.py:15: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  pyplot.xlabel(&#34;x ($\mu$m)&#34;)
/tmp/ipykernel_8549/3075494742.py:16: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  pyplot.ylabel(&#34;r ($\mu$m)&#34;)
/tmp/ipykernel_8549/3075494742.py:29: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  pyplot.xlabel(&#34;x ($\mu$m)&#34;)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Ca$^{+2}$ (nM)&#39;)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/rxd-tutorials_radial_diffusion_12_2.png" src="../_images/rxd-tutorials_radial_diffusion_12_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/rxd-tutorials_radial_diffusion_12_3.png" src="../_images/rxd-tutorials_radial_diffusion_12_3.png" />
</div>
</div>
<p>The heatmap shows the concentration of calcium (in nM) along the length of the dendrite (x-axis) and across the radial shells (y-axis) after 2.5ms. The second plot shows the concentration in each of the shells over the whole length of the neuron (the soma connects to the dendrite at x=0).</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Changing%20initial%20conditions%20and%20parameters.html" class="btn btn-neutral float-left" title="Varying initial concentrations and parameters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="thresholds.html" class="btn btn-neutral float-right" title="Reaction-diffusion thresholds" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Duke, Yale and the Blue Brain Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>